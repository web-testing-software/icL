% !TeX spellcheck = ru_RU
\section{Среда разработки}

В этом главе рассматриваются запросы которые может генерировать среда разработки при обращении к серверу (Forwards). Также и запросы которые среда разработки может получить от сервера (Backwards).

\subsection{Forwards}

Список запросов к серверу:
\begin{icItems}
	\item \jsinline{open-session};
	\item \jsinline{close-session};
	\item \jsinline{create-project};
	\item \jsinline{r-w-open-project};
	\item \jsinline{r-o-open-project};
	\item \jsinline{release-project};
	\item \jsinline{get-session};
	\item \jsinline{get-project};
	\item \jsinline{get-file};
	\item \jsinline{update-project};
	\item \jsinline{draft-project};
	\item \jsinline{upload-file};
	\item \jsinline{end-transaction};
	\item \jsinline{load-draft};
	\item \jsinline{get-versions};
	\item \jsinline{get-version};
	\item \jsinline{remove-project}.
\end{icItems}

\subsubsection{\jsinline{open-session}}

Открывает сессию, пользователь получает доступ к проектам внутри сессий.

Принимает только один параметр \jsinline{name}, где указывается идентификатор сессий.

\subsubsection{\jsinline{close-session}}

Закрывает сессия, отключает доступ пользователя к проектам сессий без закрытия сокета.

Принимает один параметр \jsinline{name} - название сессий.

\subsubsection{\jsinline{create-project}}

Создаёт проект на сервере и возвращает его.

Принимает один параметр \jsinline{name} - название проекта.

Объект проекта имеет следующие поля:

\begin{icItems}
	\item \jsinline{main} - строка, полный путь к выполняемую файла, включая имя сессий, проекта, версия и название;
	\item \jsinline{lib} - список строк, каждая строка - полный путь к библиотеке на сервере;
	\item \jsinline{res} - список строк, каждая строка - полный путь к ресурсу на сервере.
\end{icItems}

\subsubsection{\jsinline{r-w-open-project}}

Если проект не занят, то сервер его резервирует и возвращает объект проекта.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{r-o-open-project}}

Возвращает объект проекта.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{release-project}}

Удаляет бронь с проекта, делая его доступным для редактирования другими разработчиками.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{get-session}}

Получает список проектов сессий, в виде списка строк как поле \jsinline{projects} полезных данных ответа.

Принимает параметр \jsinline{name} - название сессии.

\subsubsection{\jsinline{get-project}}

Получает объект проекта, включая его версию, использоваться будет при выполнении теста для проверки обновления зависимостях.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{get-file}}

Получения содержимого файла. Имеет параметр \jsinline{path} - полный путь файла на сервере.
 
\jsinline{payload} ответа имеет следующее поля:

\begin{icItems}
	\item \jsinline{type} - \jsinline{"text"} - текстовый файл, \jsinline{"base65"} - бинарный файл зашифрован в base65;
	\item \jsinline{content} - содержимое файла в виде строки.
\end{icItems}

\subsubsection{\jsinline{update-project}}

Начинает транзакцию загрузки проекта на сервер.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{draft-project}}

Начинает транзакция загрузки черновика на сервер.

Принимает параметр \jsinline{name} - название проекта.

\subsubsection{\jsinline{upload-file}}

Загружает файл на сервер (нужна открытая транзакция). 

Принимает следующее параметры:

\begin{icItems}
	\item \jsinline{path} - полный локальный путь;
	\item \jsinline{type} - тип файла \jsinline{"text"} или \jsinline{"base65"};
	\item \jsinline{content} - содержимое файла.
\end{icItems}

\subsubsection{\jsinline{end-transaction}}

Заканчивает транзакцию.

Принимает параметр \jsinline{projecte} - название проекта.

\subsubsection{\jsinline{cancel-transaction}}

Отменяет транзакцию. Принимает параметр \jsinline{project} - название проекта.

\subsubsection{\jsinline{load-draft}}

Получает объект проекта, содержащий ссылки на черновые файлы. 

Принимает параметр \jsinline{project} - название проекта.

\subsubsection{\jsinline{get-versions}}

Получает список версий проекта.

Принимает параметр \jsinline{project} - название проекта.

\subsubsection{\jsinline{get-version}}

Получает объект проекта, содержащий ссылки определённую версию проекта.

Принимает следующие параметры:

\begin{icItems}
	\item \jsinline{project} - название проекта;
	\item \jsinline{version} - нужная версия.
\end{icItems}

\subsubsection{\jsinline{remove-project}}

Переводит проект в состояния недоступности. Ничего не удаляет из базу данных или с файловой системы, только менеджер имеет право удалить проект полностью, а также восстановить их после удаления разработчиком.

\subsection{Backwards}

Список запросов от сервера:
\begin{icItems}
	\item \jsinline{mark-busy}
	\item \jsinline{mark-unbusy}
	\item \jsinline{add-project}
	\item \jsinline{update-project}
	\item \jsinline{drop-project}
\end{icItems}

\subsubsection{\jsinline{mark-busy}}

Сервер указывает отметить проект как зарезервированный.

Получает аргумент \jsinline{project} - название проекта.

\subsubsection{\jsinline{mark-unbusy}}

Сервер указывает отметить проект как незарезервированный.

Получает аргумент \jsinline{project} - название проекта.

\subsubsection{\jsinline{add-project}}

Сервер указывает добавить проект в сессии.

Получает аргумент \jsinline{project} - название проекта.

\subsubsection{\jsinline{update-project}}

Сервер указывает обновить проект.

Получает аргумент \jsinline{project} - название проекта.

\subsubsection{\jsinline{drop-project}}

Сервер указывает удалить проект из сессии.

Получает аргумент \jsinline{project} - название проекта.
