% !TeX spellcheck = ro_RO
\section{Integrația cu JavaScript}

Codul icL poate fi amorf, conținînd fragmente în limbajele: icL-Pro, JavaScript și SQL.

Pentru a descrie un fragment de cod în limbajul icL-Pro folosiți unul din următoarele literale 
\begin{minted}{icl}
icl{
	`` cod
}
`` sau
icl:pro{
	`` cod
}
\end{minted}

Aceste literale nu vor executa codul, dar vor returna o valoare de tip \mintinline{icl}{code-icl}. Pentru al executa apelați metoda \mintinline{icl}{code-icl.run (args : any ...)}. Argumentele vor fi disponibile în cod ca \mintinline{icl}{@'0}, \mintinline{icl}{@'1} ș.a.m.d.

Codul în limbajul JavaScript este integrat într-un mod asemănător.

\subsection{Valori JS}

{\bf Valorile JS} sunt principala inovare în integrația cu JavaScript. Ele permit a folosi variabile JavaScript, comod ca și variabilele icL. Ele de asemenea pot fi disponibile pentru citire și scriere sau doar pentru citire.

Fiecare valoare JS are getter, numai variabilele disponibile pentru scriere au setter. Getterii și setterii sunt fragmente de cod JavaScript. În setter valoare pentru instalare se descrie în felul următor \mintinline{icl}{@{value}} Sintaxa valorii JS:
\begin{minted}{icl}
js:value{ getter; setter };
\end{minted}

Sintaxa simplificată a valorii JS:
\begin{minted}{icl}
js:value{ getter };
\end{minted}

În calitate de valoare JS poate fi folosită orice variabilă, de exemplu titlu paginii (foaia \ref{jsvalueex}), ea rămîne disponibilă și după trecerea la altă pagină.

\begin{sourcecode}
    \captionof{listing}{Folosirea valorii JS}
    \label{jsvalueex}
    \inputminted[linenos]{icl}{../sources/jsvalueex.icL}
\end{sourcecode}

\subsection{Executarea codului JavaScript}

Pentru a descrie un fragment de cod în limbajul JavaScript folosiți unul din următoarele literale 
\begin{minted}{icl}
js{
	`` cod
}
`` sau
js@target{
	`` cod
}
\end{minted}

\mintinline{icl}{@target} este o variabilă ce conține un link la un document, tab sau fereastră. Indică unde codul trebuie executat (în ce fereastră, în care tab).

Aceste literale vor returna o valoare de tip \mintinline{icl}{code-js}. Codul poate fi executat apelînd metoda \mintinline{icl}{code-js.run (args : any ...)}. Argumentele pot fi accesate prin variabila de sistem - \mintinline{icl}{arguments}.

Folosiți metoda \mintinline{icl}{code-js.runAsync (args : any ...)} pentru a executa scriptul asincron.

\begin{sourcecode}
    \captionof{listing}{Executarea codului în limbajul JavaScript}
    \label{jsrunex1}
    \inputminted[linenos]{icl}{../sources/jsrunex1.icL}
\end{sourcecode}

Excepții posibile: \ferror{JavascriptError}, \ferror{ScriptTimeout} (pr. tab. \ref{errors}).

\subsection{Fișiere JavaScript}

Literalul \mintinline{icl}{js:file[..]} permite a deschide fișiere JavaScript. Calea spre fișier poate fi definită imediat \mintinline{icl}{js:file[calea/spre/fișier.js]} sau mai apoi \mintinline{icl}{js:file[]}.

Clasa \mintinline{icl}{js-file} are umătoarele metode:
\begin{icItems}
\item \mintinline{icl}{js-file.load (path : string) : js-file};
\item \mintinline{icl}{js-file.run (args : any ...) : js-file};
\item \mintinline{icl}{js-file.runAsync (args : any ...) : js-file};
\item \mintinline{icl}{js-file.setAsUserScript () : js-file};
\item \mintinline{icl}{js-file.setAsPersistentUserScript () : js-file}.
\end{icItems}

\subsubsection{\mintinline{icl}{js-file.load (path : string) : js-file}}

Încarcă conținutul fișierului.

Excepții posibile: \ferror{FileNotFound} (pr. tab. \ref{errors}).

\subsubsection{\mintinline{icl}{js-file.run (args : any ...) : js-file}}

Execută conținutul fișierului.

Excepții posibile: \ferror{JavascriptError}, \ferror{ScriptTimeout} (pr. tab. \ref{errors}).

\subsubsection{\mintinline{icl}{js-file.runAsync (args : any ...) : js-file}}

Execută asincron conținutul fișierului.

Excepții posibile: \ferror{JavascriptError} (pr. tab. \ref{errors}).

\subsubsection{\mintinline{icl}{js-file.setAsUserScript () : js-file}}

Setează acest script ca \i{script personal}.

\subsubsection{\mintinline{icl}{js-file.setAsPersistentUserScript () : js-file}}

Setează acest script ca \i{script personal} pentru toate taburile sesiunii.

%\newpage
